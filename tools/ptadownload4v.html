<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Embed PDF with Predefined Labels</title>
    <style>
        body { font-family: Arial, sans-serif; }
        #pdf-embed { width: 100%; height: 600px; border: 1px solid #ccc; }
        .page-container { margin-top: 20px; }
        .page-label { margin-right: 10px; font-weight: bold; }
    </style>
</head>
<body>
    <h1>View and Select Pages from PDF</h1>

    <!-- Embed the PDF directly -->
    <embed id="pdf-embed" src="ptas-4vwo-2425.pdf" type="application/pdf">

    <!-- Predefined labels and selection -->
    <div id="page-labels">
        <h3>Select Pages by Label</h3>
        <div id="label-container"></div>
    </div>

    <!-- Checkbox for downloading the appendix -->
    <div class="page-container">
        <input type="checkbox" id="appendix-checkbox" />
        <label for="appendix-checkbox" class="page-label">Download bijlage (Engels en LO toelichting))</label>
    </div>

    <!-- Button to download selected pages -->
    <div id="selected-pages">
        <button id="download-selected">Download Selected Pages</button>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
    <script>
        const pdfUrl = "ptas-4vwo-2425.pdf"; // Path to the embedded PDF file

        // Predefined labels for each page
        const pageLabels = [
            "aardrijkskunde",  // Page 1 label
            "bedrijfseconomie",    // Page 2 label
            "biology",        // Page 3 label
            "ckv",        // Page 4 label
            "Duits",      // Page 5 label
            "economie",          // Page 6 label
            "Engels 1",     // Page 7 label
            "Engels 2 (beide aanvinken)",          // Page 8 label
            "Frans 1",      // Page 9 label
            "Frans 2 (beide aanvinken)",           // Page 10 label
            "geschiedenis",      // Page 11 label
            "identiteit en maatschappij", // Page 12 label
            "informatica", // Page 13 label
            "Latijn",     // Page 14 label
            "LO",     // Page 15 label
            "muziek",   // Page 16 label
            "natuurkunde",       // Page 17 label
            "natuur leven technologie",  // Page 18 label
            "Nederlands",       // Page 19 label
            "scheikunde",   // Page 20 label
            "tekenen",        // Page 21 label
            "vaardigheid B-vakken",   // Page 22 label
            "wiskunde A", // Page 23 label
            "wiskunde B", // Page 24 label
            "wiskunde C",    // Page 25 label
            "Wiskunde D"     // Page 26 label
        ];

        const labelContainer = document.getElementById('label-container');
        const numPages = pageLabels.length; // Number of predefined labels

        // Render predefined labels and checkboxes
        for (let i = 0; i < numPages; i++) {
            const pageDiv = document.createElement('div');
            pageDiv.classList.add('page-container');
            
            const label = document.createElement('span');
            label.classList.add('page-label');
            label.textContent = `${pageLabels[i]} (Page ${i + 1})`;
            
            const checkbox = document.createElement('input');
            checkbox.type = 'checkbox';
            checkbox.id = `checkbox-${i + 1}`;
            checkbox.dataset.page = i + 1;

            pageDiv.appendChild(label);
            pageDiv.appendChild(checkbox);
            labelContainer.appendChild(pageDiv);
        }

        // Handle downloading selected pages
        document.getElementById('download-selected').addEventListener('click', async function() {
            const selectedPageNumbers = [];
            for (let i = 1; i <= numPages; i++) {
                const checkbox = document.getElementById(`checkbox-${i}`);
                if (checkbox.checked) {
                    selectedPageNumbers.push(parseInt(checkbox.dataset.page));
                }
            }

            // Check if the appendix checkbox is selected
            if (document.getElementById('appendix-checkbox').checked) {
                for (let i = 27; i <= 32; i++) {
                    selectedPageNumbers.push(i);
                }
            }

            if (selectedPageNumbers.length > 0) {
                const newPdf = await createNewPdf(selectedPageNumbers);
                downloadPdf(newPdf);
            } else {
                alert("No pages selected!");
            }
        });

        // Create a new PDF containing selected pages
        async function createNewPdf(pages) {
            const pdfBytes = await fetch(pdfUrl).then(res => res.arrayBuffer());
            const existingPdf = await PDFLib.PDFDocument.load(pdfBytes);
            const newPdf = await PDFLib.PDFDocument.create();

            for (let pageNum of pages) {
                const [copiedPage] = await newPdf.copyPages(existingPdf, [pageNum - 1]);
                newPdf.addPage(copiedPage);
            }

            const pdfBytesNew = await newPdf.save();
            return pdfBytesNew;
        }

        // Trigger download of the new PDF
        function downloadPdf(pdfBytes) {
            const blob = new Blob([pdfBytes], { type: 'application/pdf' });
            const link = document.createElement('a');
            link.href = window.URL.createObjectURL(blob);
            link.download = 'selected_pages.pdf';
            link.click();
        }
    </script>
</body>
</html>
